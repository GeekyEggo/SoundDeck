<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="utf-8" />
        <title>App Media Controls Settings</title>
        <script type="text/javascript">
            function connectElgatoStreamDeckSocket(inPort, inPropertyInspectorUUID, inRegisterEvent, inInfo, inActionInfo) {
                const { payload: { controller } } = JSON.parse(inActionInfo);
                if (controller == 'Keypad') {
                    document.querySelector('sdpi-item[label="Action"]').style.display = '';
                }
            }
        </script>
        <script src="./js/sdpi-components.js"></script>
    </head>
    <body>
        <sdpi-item label="App">
            <sdpi-select setting="processSelectionType" datasource="getMultimediaSessions" label-setting="processLabel" loading="Loading..." placeholder="Foreground (Active)"></sdpi-select>
        </sdpi-item>

        <sdpi-item label="Name" style="display: none;">
            <sdpi-textfield setting="processName"></sdpi-textfield>
        </sdpi-item>

        <sdpi-item label="Action" style="display: none">
            <sdpi-select setting="action" value-type="number" placeholder="Play / Pause">
                <option value="0">Play / Pause</option>
                <option value="1">Play</option>
                <option value="2">Pause</option>
                <option value="3">Stop</option>
                <option value="4">Skip Previous</option>
                <option value="5">Skip Next</option>
            </sdpi-select>
        </sdpi-item>

        <sdpi-item label="Display">
            <sdpi-select setting="preferredIcon" placeholder="Artwork (When Available)">
                <option value="0">App</option>
                <option value="1">Artwork (When Available)</option>
            </sdpi-select>
        </sdpi-item>

        <script>
            document.querySelector('sdpi-select[setting="processSelectionType"]').addEventListener('valuechange', ev => {
                document.querySelector('sdpi-item[label="Name"]').style.display = ev.srcElement.value == 1 ? '' : 'none';
            });
        </script>
    </body>
</html>